<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
		<script src="https://use.fontawesome.com/c745680a1c.js"></script>	
		<link rel="stylesheet" href="highlight/styles/atelier-dune-dark.css">
		<script src="highlight/highlight.pack.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>

		<link rel="shortcut icon" href="../favicon.png">

		<link rel="stylesheet" href="../css/style.min.css">
		<title>Zachary Hart - CSCI.712</title>
	</head>
	<body>
		<div class="container-fluid">
			<div class="row">
				<div class="col-lg-8 offset-lg-2 col-sm-10 offset-sm-1 col-xs-10 offset-xs-1">
					<h1 class="display-2" style="margin-top: 1rem">CSCI.<strong>712</strong> Assignments</h1>
				</div>
			</div>
			<br/>
			<div class="row">
				<div class="col-lg-8 offset-lg-2 col-sm-10 offset-sm-1 col-xs-10 offset-xs-1">
					<div class="accordion" id="assignmentsList">
						<!--							
    ___              _                                  __     _____                 
   /   |  __________(_)___ _____  ____ ___  ___  ____  / /_   /__  /  ___  _________ 
  / /| | / ___/ ___/ / __ `/ __ \/ __ `__ \/ _ \/ __ \/ __/     / /  / _ \/ ___/ __ \
 / ___ |(__  |__  ) / /_/ / / / / / / / / /  __/ / / / /_      / /__/  __/ /  / /_/ /
/_/  |_/____/____/_/\__, /_/ /_/_/ /_/ /_/\___/_/ /_/\__/     /____/\___/_/   \____/ 
                   /____/                                                            
						-->
						<div class="card">
							<div class="card-header" id="assignmentZero">
								<div class="row">
									<div class="col-3">
										<h4 class="mb-0">
											<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseZero">
												Assignment Zero 
											</button>
										</h4>
									</div>
									<div class="col-3 offset-6">
										<p class="text-right"><span class="badge badge-secondary">Last Updated: 09/17/2019</span></p>
									</div>
								</div>
							</div>
							
							<div id="collapseZero" class="card card-body collapse" data-parent="#assignmentsList">
								<div class="col-12">
									<p class="lead">
									Basic engine set up for following assignments
									</p>

									<video class="rounded mx-auto d-block img-fluid" width=100% height=auto controls>
										<source src="framework.mp4" type="video/mp4">
									</video>
								</div>
							</div>
						</div>
						<!--							
    ___              _                                  __     ____           
   /   |  __________(_)___ _____  ____ ___  ___  ____  / /_   / __ \____  ___ 
  / /| | / ___/ ___/ / __ `/ __ \/ __ `__ \/ _ \/ __ \/ __/  / / / / __ \/ _ \
 / ___ |(__  |__  ) / /_/ / / / / / / / / /  __/ / / / /_   / /_/ / / / /  __/
/_/  |_/____/____/_/\__, /_/ /_/_/ /_/ /_/\___/_/ /_/\__/   \____/_/ /_/\___/ 
                   /____/                                                     
						-->
						<div class="card">
							<div class="card-header" id="assignmentOne">
								<div class="row">
									<div class="col-3">
										<h4 class="mb-0">
											<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne">
												Assignment One
											</button>
										</h4>
									</div>
									<div class="col-3 offset-6">
										<p class="text-right"><span class="badge badge-secondary">Last Updated: 10/01/2019</span></p>
									</div>
								</div>
							</div>

							<div id="collapseOne" class="card card-body collapse" data-parent="#assignmentsList">
								<div class="col-12">
									<p class="lead"> 
									Base Submission
									</p>
									<ul>
										<li>Translational motion interpolated via <strong><code>lerp()</code></strong></li>
										<li>Rotational motion interpolated via <strong><code>slerp()</code></strong> of quaternions</li>
									</ul>
									<video class="rounded mx-auto d-block img-fluid" width=100% height=auto controls>
										<source src="keyframing.mp4" type="video/mp4">
									</video>
								</div>
							</div>
						</div>
						<!--
    ___              _                                  __     ______             
   /   |  __________(_)___ _____  ____ ___  ___  ____  / /_   /_  __/      ______ 
  / /| | / ___/ ___/ / __ `/ __ \/ __ `__ \/ _ \/ __ \/ __/    / / | | /| / / __ \
 / ___ |(__  |__  ) / /_/ / / / / / / / / /  __/ / / / /_     / /  | |/ |/ / /_/ /
/_/  |_/____/____/_/\__, /_/ /_/_/ /_/ /_/\___/_/ /_/\__/    /_/   |__/|__/\____/ 
                   /____/                                                         
						-->
						<div class="card">
							<div class="card-header" id="assignmentTwo">
								<div class="row">
									<div class="col-3">
										<h4 class="mb-0">
											<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseTwo">
												Assignment Two
											</button>
										</h4>
									</div>
									<div class="col-3 offset-6">
										<p class="text-right"><span class="badge badge-success">Last Updated: <strong>10/27/2019</strong></span></p>
									</div>
								</div>
							</div>
							
							<div id="collapseTwo" class="card card-body collapse show" data-parent="#assignmentsList">
								<div class="col-12">
									<p class="lead"> 
									Base Submission 
									</p>
									<ul>
										<li> No rotational motion simulated </li>
										<li> Euler integration </li>
										<li> Coefficient of Friction: <strong><code>0.2</code></strong></li>
										<li> Coefficient of Restitution: <strong><code>0.5</code></strong></li>
									</ul>
									<video class="rounded mx-auto d-block img-fluid" width=75% height=auto controls>
										<source src="dynamics.mp4" type="video/mp4">
									</video>
									<hr/>

									<p class="lead"> 
									High Coefficient of Friction
									</p>
									<ul>
										<li> Coefficient of Friction: <strong><s><code style="color: red">0.2</code></s></strong> <strong><i class="fa fa-chevron-up text-success"></i> <code>0.8</code></strong></li>
										<li> Coefficient of Restitution: <strong><code>0.5</code></strong></li>
									</ul>
									<video class="rounded mx-auto d-block img-fluid" width=100% height=auto controls>
										<source src="dynamics_high_friction.mp4" type="video/mp4">
									</video>
									<hr />

									<p class="lead"> 
									High Coefficient of Restitution
									</p>
									<ul>
										<li> Coefficient of Friction: <strong><code>0.2</code></strong></li>
										<li> Coefficient of Restitution: <strong><s><code style="color: red">0.5</code></s></strong> <strong><i class="fa fa-chevron-up text-success"></i> <code>0.99</code></strong></li>
									</ul>
									<video class="rounded mx-auto d-block img-fluid" width=100% height=auto controls>
										<source src="dynamics_high_restitution.mp4" type="video/mp4">
									</video>
									<hr />

									<p class="lead"> 
									<strong>Bonus:</strong> Quick &amp; Dirty Pocket Implementation
									</p>
									<p>
										Ball-pocket collision is detected in the same way as ball-ball collision. In this
										implementation, pockets are actually spherical models that are scaled to
										<code>1.5<var>x</var></code> the dimensions of the balls in the simulation. If a 
										collision between any of the object balls, or the cue ball is detected, a force 
										with a z component of lua's <strong><code>math.huge</code></strong> is applied on 
										the ball, sending it very far away from the table.
									</p>
									<video class="rounded mx-auto d-block img-fluid" width=100% height=auto controls>
										<source src="dynamics_pockets.mp4" type="video/mp4">
									</video>
									<hr />

									<p class="lead">
									<strong>Update</strong>: Physically accurate collisions of 
									<code><strong><var>n</var> &gt; 1</strong></code> balls - 10/27/2019
									</p>
										<p>
										This version of the animation has several important changes that allow for more 
										accurate collisions of an action ball against more than 1 target balls. Previous
										to now, the collision detection routine worked in the following way:
								
										<pre class="pre-scrollable"><code class="lua">-- Outer loop context, <var>i</var> is the ball currently considered the "action" ball
for j=1, #Balls do
    -- Can't collide with ourselves
    if i ~= j then
        -- Get position of Balls[j]
        -- Determine if balls were intersecting
        if interesecting then
           -- Calculate how far back to move <strong>then apply</strong> that translation
           -- Calculate the action line of the collision, calculate the impulse from collision
           -- Apply the forces to both Balls[i] and Balls[j]
        end
    end
end</code></pre>
									<p>
										This had an unfortunate side effect, and it's bolded above. In the case where one
										ball was colliding with more than one other ball, the ball that was numerically
										first in the <code><strong>Balls</strong></code> array would be the ball that determined
										where to place the action ball to resolve the intersection, thus potentially
										<em>undoing</em> other collisions, or even <em>modifying</em> the action 
										line of those collisions in the worst case.

										This resulted in the behavior above where the <span style="color: #3498DB">blue</span>
										target ball has a larger impulse force acted upon it than the
										<span style="color: #E74C3C">red</span> target ball, despite being positioned such that
										the <span class="text-success">green</span> action ball would impact both at the same
										time and rate.
									</p>

									<p>
										Logic and experience playing pool (and enough time in Linear Algebra lectures)
										dictates that the magnitude of the impulse forces acted upon the two target balls
										would be the same, and would sum to the magnitude of the momentum that the target
										ball had just prior to impact (all this assuming that our collisions are perfectly
										elastic, and that the energy lost to friction in that instant was negligible).
									</p>
									<p class="lead">
										When we consider collision detection and collision resolution to be
										two <strong>distinct</strong> stages of our algorithm, we see the following:
									</p>
									<video class="rounded mx-auto d-block img-fluid" width=100% height=auto controls>
										<source src="dynamics_collision_fixed.mp4" type="video/mp4">
									</video>
									<p>
										<small class="text-muted">Note that we pocketed both the <span style="color: #E74C3C">red</span> and
										<span style="color: #3498DB">blue</span> balls on our first shot, and missed
										on the second - the amount the <span style="color: green">green</span> ball
										was moved back to resolve the collision on each shot was slightly different due to 
										floating point error when calculating the amount of intersection, resulting in an 
										action line that is inconsistent. Pool really is a game of luck sometimes.</small>
									</p>
									<p>
										Breaking up our collision handling into a two-step <strong>detect</strong> then 
										<strong>resolve</strong> process allows us to determine every ball that should be
										affected by the collision without changing the state of any, <em>then</em> 
										taking a second pass through only the subset of balls that <strong>should</strong>
										be acted upon this step to apply each target ball's share of the overall transfer
										of momentum. The following snippet is roughly how detection is happening in this
										two-step process.
										<pre class="pre"><code class="lua">-- Outer loop context, <var>i</var> is the ball currently considered the "action" ball
-- Determine which balls we're colliding with on this particular framestep, and where we need to move
-- such that we are not colliding with any

-- The vec3 position that will resolve _all_ collisions on this framestep
local collision_resolve = nil

-- The scalar distance between the center of this ball and any other
-- assuming we're at the above position
local apply_prev_resolve = nil

-- A subset of Balls containing each model that we are colliding with on this framestep
local colliding_with = {}

-- By default, zero impulse will be added to the action ball this framestep
-- (unless modified by collisions)
local impulse = cpml.vec3.zero

for j=1, #Balls do
    if j ~= i then
        -- Determine if there is an intersection of balls
        local center_dist = action_position:dist(target_position)
        if intersecting then
            colliding_with[#colliding_with+1] = Balls[j]  -- Store this target ball
            if collision_resolve ~= nil then
                -- If we've previously resolved a collision, get our "new" distance
                -- (we haven't yet moved our action ball)
            end

            if apply_prev_resolve ~= nil and apply_prev_resolve_intersecting then
                -- We still have a collision we need to resolve
            else
                -- This is the first collision we are resolving, set up our initial resolution
                local move_back = action_velocity:normalize()*-1*(2*BALL_RADIUS-center_dist)
                -- move_back has direction opposite action_velocity
                collision_resolve = action_position + move_back 
            end
        end
    end
end</code></pre>
									</p>
									<hr />
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row align-items-end footer">
				<div class="col-lg-3 offset-lg-2 col-sm-4">
					<p><small class="text-muted">All work &copy; Zachary Hart 2019</small></p>
				</div>
				<div class="col-lg-2 col-sm-4">
					<p class="text-center"><small><a href="https://zach.moe/">❤️</a></small></p>
				</div>
				<div class="col-lg-3 col-sm-4">
					<p class="text-right"><small class="text-muted">Syntax highlighting in code snippets by <a href="https://highlightjs.org/">highlight.js</a></small></p>
				</div>
			</div>
		</div>
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	</body>
</html>
